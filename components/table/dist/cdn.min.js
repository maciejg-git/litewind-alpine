(()=>{function o(i){i.data("table",()=>{let a=t=>t??"",l=t=>Object.prototype.toString.call(t)=="[object Date]",n=(t,e)=>t<e?-1:t>e?1:0,h=(t,e,r,s)=>(t=a(t),e=a(e),l(t)&&l(e)?n(t,e)*r:typeof t=="number"&&typeof e=="number"?isNaN(t)&&!isNaN(e)?-1:!isNaN(t)&&isNaN(e)?1:n(t,e)*r:s(t,e)*r),f=t=>t.replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()),d=(t,e,r)=>(r=r||"match",(t+"").replace(new RegExp(`(${e.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")})`,"i"),`<span class='${r}'>$1</span>`)),u={sortable:!1,filterable:!0,visible:!0};return{sortKey:"",sortAsc:1,data:[],tableData:[],definition:[],filter:"",page:1,itemsPerPage:0,locale:"en-GB",primaryKey:"",onFilter:null,isLoading:!1,init(){this.$nextTick(()=>{i.effect(()=>{let t=i.bound(this.$el,"data-items")??this.data;this.tableData=[...t],this.definition=this.getDefinition()}),i.effect(()=>{this.filter=i.bound(this.$el,"data-filter")??this.filter,this.page=1}),i.effect(()=>{this.itemsPerPage=parseInt(i.bound(this.$el,"data-items-per-page")??this.itemsPerPage),this.page=1}),i.effect(()=>{this.locale=i.bound(this.$el,"data-locale")??this.locale}),i.effect(()=>{this.onFilter=i.bound(this.$el,"data-on-filter")??this.onFilter}),i.effect(()=>{this.page=parseInt(i.bound(this.$el,"data-page")??this.page)}),i.effect(()=>{this.isLoading=JSON.parse(i.bound(this.$el,"data-is-loading")??this.isLoading)}),this.primaryKey=i.bound(this.$el,"data-primary-key")??this.primaryKey,i.bind(this.$el,{":class"(){let t=this.$el.attributes,e="";return this.isLoading&&(e=t["class-loading"]?.textContent||""),e}})})},generateDefinitionFromData(){return!this.tableData||!this.tableData.length?[]:Object.keys(this.tableData[0]).map(t=>({key:t}))},getUserDefinition(){let t=i.bound(this.$el,"data-definition");return Array.isArray(t)?t.every(e=>e.key)&&t:!1},getDefinition(){return(this.getUserDefinition()||this.generateDefinitionFromData()).map(e=>({...u,...e,label:e.label||f(e.key)}))},getDataSorted(){if(!this.sortKey)return this.tableData;let t=new Intl.Collator(this.locale).compare;return this.tableData.sort((e,r)=>h(e[this.sortKey],r[this.sortKey],this.sortAsc,t))},getFilterableKeys(){return this.definition.filter(t=>t.filterable!==!1&&t.visible!==!1).map(t=>t.key)},getDataFiltered(){if(!this.filter)return this.getDataSorted();let t=new RegExp(this.filter.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&"),"i"),e=this.getFilterableKeys();return this.getDataSorted().filter(s=>e.some(c=>(s[c]+"").search(t)!==-1))},getDataPaginated(){let t=this.getDataFiltered();return typeof this.onFilter=="function"&&this.onFilter(t),this.$dispatch("update:items-filtered",t),this.itemsPerPage?t.slice((this.page-1)*this.itemsPerPage,this.page*this.itemsPerPage):t},getCellContent(){return this.row[this.col.key]},getHighlightedCellContent(){return d(this.row[this.col.key],this.filter)},isSortable(){return this.col.sortable},isSorted(){return this.sortKey===this.col.key},isSortedAsc(){return this.isSorted()&&this.sortAsc===1},isSortedDesc(){return this.isSorted()&&this.sortAsc===-1},header:{"@click"(){this.isSortable()&&(this.sortAsc=this.sortKey===this.col.key?-this.sortAsc:1,this.sortKey=this.col.key)},":class"(){return this.isSortable()?"cursor-pointer":""}}}})}document.addEventListener("alpine:init",()=>{Alpine.plugin(o)});})();
