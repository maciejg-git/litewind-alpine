(()=>{function D(s){s.data("datepicker",(c={})=>{let g=(t,e)=>Array.from({length:e},(r,a)=>a+t),y=(t,e)=>32-new Date(t,e,32).getDate(),u=(t,e)=>t-1<0?{m:11,y:e-1}:{m:t-1,y:e},m=(t,e)=>t+1>11?{m:0,y:e+1}:{m:t+1,y:e},S=(t,e,r)=>{let a=new Date(t,e).getDay();return r?(6+a)%7:a},f=t=>{try{return Intl.getCanonicalLocales(t),1}catch(e){console.warn(e)}},n={UNSELECTED:0,FROM_SELECTED:1,TO_SELECTED:2},h={};return["prevYearButton","prevMonthButton","nextMonthButton","nextYearButton","day"].forEach(t=>{c[t]&&(h[t]=c[t],delete c[t])}),{today:new Date,month:null,year:null,names:{months:null,weekdays:null},_model:"",selectedSingle:null,selectedRange:[],rangeState:0,mouseOverDate:null,locale:"en-GB",mondayFirstWeekday:!0,adjacentMonthsDays:!0,range:!1,init(){this.month=this.today.getMonth(),this.year=this.today.getFullYear(),this.$nextTick(()=>{s.effect(()=>{let t=s.bound(this.$el,"data-locale")??this.locale;this.locale=f(t)?t:this.locale,this.names.months=this.getMonthNames(),this.names.weekdays=this.getWeekdayNames()}),s.effect(()=>{this.mondayFirstWeekday=JSON.parse(s.bound(this.$el,"data-monday-first-weekday")??this.mondayFirstWeekday)}),s.effect(()=>{this.adjacentMonthsDays=JSON.parse(s.bound(this.$el,"data-adjacent-months-days")??this.adjacentMonthsDays)}),s.effect(()=>{this.range=JSON.parse(s.bound(this.$el,"data-range")??this.range),this.reset()})}),s.effect(()=>{let t=/^\d{4}-\d{2}-\d{2}$/;if(this.range){if(this._model?.length===2){this._model.every(e=>t.test(e))&&(this.selectedRange=this._model.map(e=>new Date(e)),this.rangeState=n.TO_SELECTED);return}this._model?.length===0&&(this.selectedRange=[],this.rangeState=n.UNSELECTED);return}(this._model===""||this._model===null)&&(this.selectedSingle=null),t.test(this._model)&&(this.selectedSingle=new Date(this._model))}),s.bind(this.$el,{"x-modelable":"_model"})},getMonthNames(){return Array.from({length:12},(t,e)=>new Date(0,e,1).toLocaleString(this.locale,{month:"short"}))},getWeekdayNames(){return Array.from({length:7},(t,e)=>new Date(2021,1,this.mondayFirstWeekday?e+1:e).toLocaleString(this.locale,{weekday:"short"}))},dateToModel(t){return t.toISOString().substring(0,10)},todayFormatted(){return this.today.toLocaleDateString(this.locale,{weekday:"long",year:"numeric",month:"long",day:"numeric"})},setNextMonth(){({m:this.month,y:this.year}=m(this.month,this.year))},setPrevMonth(){({m:this.month,y:this.year}=u(this.month,this.year))},setNextYear(){this.year++},setPrevYear(){this.year--},weekdays(){return this.names.weekdays},days(){let t=S(this.year,this.month,this.mondayFirstWeekday),e=y(this.year,this.month),r=g(1,e);r=r.map(i=>new Date(Date.UTC(this.year,this.month,i)));let{m:a,y:l}=u(this.month,this.year),E=y(l,a),o=g(E-t+1,t);this.adjacentMonthsDays?o=o.map(i=>new Date(Date.UTC(l,a,i))):o=o.map(i=>new Date(Date.UTC(l,a,i))),{m:a,y:l}=m(this.month,this.year);let M=42-e-t,d=null;return this.adjacentMonthsDays?(d=g(1,M),d=d.map(i=>new Date(Date.UTC(l,a,i)))):d=[],[...o,...r,...d]},currentDate(){return this.names.months?`${this.names.months[this.month]} ${this.year}`:""},reset(){this.selectedSingle="",this.selectedRange=[],this._model="",this.rangeState=n.UNSELECTED,this.mouseOverDate=null},addRange(){this.rangeState===n.TO_SELECTED&&(this.selectedRange=[],this.rangeState=n.UNSELECTED),this.selectedRange[this.rangeState]=this.d,this.rangeState++,this.rangeState===n.TO_SELECTED&&this.selectedRange[0]>this.selectedRange[1]&&this.selectedRange.reverse()},getDayKey(){return this.d.toISOString()+this.isAdjacent()},getDayText(){return this.d.getDate()},isToday(){return this.today.getDate()===this.d.getUTCDate()&&this.today.getMonth()===this.d.getUTCMonth()&&this.today.getFullYear()===this.d.getUTCFullYear()},isAdjacent(){return this.d.getMonth()!==this.month},isSelected(){return this.selectedSingle&&this.selectedSingle.getTime()==this.d.getTime()},isSelectedRange(){return this.range&&this.rangeState===n.TO_SELECTED?this.selectedRange[0]<=this.d&&this.d<=this.selectedRange[1]:!1},isPartiallySelected(){return this.range&&this.rangeState===n.FROM_SELECTED?this.mouseOverDate>=this.d&&this.d>=this.selectedRange[0]||this.mouseOverDate<=this.d&&this.d<=this.selectedRange[0]:!1},handleDayClick(){if(this.isAdjacent()&&(this.month=this.d.getMonth(),this.year=this.d.getFullYear()),this.range){this.addRange(),this._model=this.selectedRange.map(t=>this.dateToModel(t));return}this.selectedSingle=this.d,this._model=this.dateToModel(this.selectedSingle),(!this.range||this.rangeState===n.TO_SELECTED)&&this.$dispatch("datepicker-selection-complete")},prevMonthButton:{"@click"(){this.setPrevMonth()},...h.prevMonthButton},nextMonthButton:{"@click"(){this.setNextMonth()},...h.nextMonthButton},prevYearButton:{"@click"(){this.setPrevYear()},...h.prevYearButton},nextYearButton:{"@click"(){this.setNextYear()},...h.nextYearButton},day:{":class"(){let t=this.$el.attributes,e="";if(this.isAdjacent()){if(!this.adjacentMonthsDays){this.$el.style.visibility="hidden";return}return t["class-adjacent"]?.textContent||""}return this.isSelected()?e+=(t["class-selected"]?.textContent||"")+" ":this.isSelectedRange()?e+=(t["class-selected-range"]?.textContent||"")+" ":this.isPartiallySelected()?e+=(t["class-partially-selected"]?.textContent||"")+" ":typeof this.isDisabled=="function"&&this.isDisabled(this.d)?e+=(t["class-disabled"]?.textContent||"")+" ":e+=(t["class-default"]?.textContent||"")+" ",this.isToday()&&(e+=(t["class-today"]?.textContent||"")+" "),e},"@click"(){this.handleDayClick()},"@mouseenter"(){this.mouseOverDate=this.d},...h.day},...c}})}document.addEventListener("alpine:init",()=>{Alpine.plugin(D)});})();
