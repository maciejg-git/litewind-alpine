(()=>{function m(s){s.data("datepicker",()=>{let o=(e,t)=>Array.from({length:t},(h,a)=>a+e),c=(e,t)=>32-new Date(e,t,32).getDate(),g=(e,t)=>e-1<0?{m:11,y:t-1}:{m:e-1,y:t},y=(e,t)=>e+1>11?{m:0,y:t+1}:{m:e+1,y:t},u=(e,t,h)=>{let a=new Date(e,t).getDay();return h?(6+a)%7:a},D=e=>{try{return Intl.getCanonicalLocales(e),1}catch(t){console.warn(t)}},i={UNSELECTED:0,FROM_SELECTED:1,TO_SELECTED:2};return{today:new Date,month:null,year:null,names:{months:null,weekdays:null},_model:"",selectedSingle:null,selectedRange:[],rangeState:0,mouseOverDate:null,locale:"en-GB",mondayFirstWeekday:!0,adjacentMonthsDays:!0,range:!1,init(){this.month=this.today.getMonth(),this.year=this.today.getFullYear(),this.$nextTick(()=>{s.effect(()=>{let e=s.bound(this.$el,"data-locale")??this.locale;this.locale=D(e)?e:this.locale,this.names.months=this.getMonthNames(),this.names.weekdays=this.getWeekdayNames()}),s.effect(()=>{this.mondayFirstWeekday=JSON.parse(s.bound(this.$el,"data-monday-first-weekday")??this.mondayFirstWeekday)}),s.effect(()=>{this.adjacentMonthsDays=JSON.parse(s.bound(this.$el,"data-adjacent-months-days")??this.adjacentMonthsDays)}),s.effect(()=>{this.range=JSON.parse(s.bound(this.$el,"data-range")??this.range),this.reset()})}),s.effect(()=>{let e=/^\d{4}-\d{2}-\d{2}$/;if(this.range){if(this._model?.length===2){this._model.every(t=>e.test(t))&&(this.selectedRange=this._model.map(t=>new Date(t)),this.rangeState=i.TO_SELECTED);return}this._model?.length===0&&(this.selectedRange=[],this.rangeState=i.UNSELECTED);return}(this._model===""||this._model===null)&&(this.selectedSingle=null),e.test(this._model)&&(this.selectedSingle=new Date(this._model))}),s.bind(this.$el,{"x-modelable":"_model"})},getMonthNames(){return Array.from({length:12},(e,t)=>new Date(0,t,1).toLocaleString(this.locale,{month:"short"}))},getWeekdayNames(){return Array.from({length:7},(e,t)=>new Date(2021,1,this.mondayFirstWeekday?t+1:t).toLocaleString(this.locale,{weekday:"short"}))},dateToModel(e){return e.toISOString().substring(0,10)},todayFormatted(){return this.today.toLocaleDateString(this.locale,{weekday:"long",year:"numeric",month:"long",day:"numeric"})},setNextMonth(){({m:this.month,y:this.year}=y(this.month,this.year))},setPrevMonth(){({m:this.month,y:this.year}=g(this.month,this.year))},setNextYear(){this.year++},setPrevYear(){this.year--},weekdays(){return this.names.weekdays},days(){let e=u(this.year,this.month,this.mondayFirstWeekday),t=c(this.year,this.month),h=o(1,t);h=h.map(n=>new Date(Date.UTC(this.year,this.month,n)));let{m:a,y:l}=g(this.month,this.year),S=c(l,a),r=o(S-e+1,e);this.adjacentMonthsDays?r=r.map(n=>new Date(Date.UTC(l,a,n))):r=r.map(n=>new Date(Date.UTC(l,a,n))),{m:a,y:l}=y(this.month,this.year);let f=42-t-e,d=null;return this.adjacentMonthsDays?(d=o(1,f),d=d.map(n=>new Date(Date.UTC(l,a,n)))):d=[],[...r,...h,...d]},currentDate(){return this.names.months?`${this.names.months[this.month]} ${this.year}`:""},reset(){this.selectedSingle="",this.selectedRange=[],this._model="",this.rangeState=i.UNSELECTED,this.mouseOverDate=null},addRange(){this.rangeState===i.TO_SELECTED&&(this.selectedRange=[],this.rangeState=i.UNSELECTED),this.selectedRange[this.rangeState]=this.d,this.rangeState++,this.rangeState===i.TO_SELECTED&&this.selectedRange[0]>this.selectedRange[1]&&this.selectedRange.reverse()},getDayKey(){return this.d.toISOString()+this.isAdjacent()},getDayText(){return this.d.getDate()},isToday(){return this.today.getDate()===this.d.getUTCDate()&&this.today.getMonth()===this.d.getUTCMonth()&&this.today.getFullYear()===this.d.getUTCFullYear()},isAdjacent(){return this.d.getMonth()!==this.month},isSelected(){return this.selectedSingle&&this.selectedSingle.getTime()==this.d.getTime()},isSelectedRange(){return this.range&&this.rangeState===i.TO_SELECTED?this.selectedRange[0]<=this.d&&this.d<=this.selectedRange[1]:!1},isPartiallySelected(){return this.range&&this.rangeState===i.FROM_SELECTED?this.mouseOverDate>=this.d&&this.d>=this.selectedRange[0]||this.mouseOverDate<=this.d&&this.d<=this.selectedRange[0]:!1},handleDayClick(){if(this.isAdjacent()&&(this.month=this.d.getMonth(),this.year=this.d.getFullYear()),this.range){this.addRange(),this._model=this.selectedRange.map(e=>this.dateToModel(e));return}this.selectedSingle=this.d,this._model=this.dateToModel(this.selectedSingle),(!this.range||this.rangeState===i.TO_SELECTED)&&this.$dispatch("datepicker-selection-complete")},prevMonthButton:{"@click"(){this.setPrevMonth()}},nextMonthButton:{"@click"(){this.setNextMonth()}},prevYearButton:{"@click"(){this.setPrevYear()}},nextYearButton:{"@click"(){this.setNextYear()}},day:{":class"(){let e=this.$el.attributes,t="";if(this.isAdjacent()){if(!this.adjacentMonthsDays){this.$el.style.visibility="hidden";return}return e["class-adjacent"]?.textContent||""}return this.isSelected()?t+=(e["class-selected"]?.textContent||"")+" ":this.isSelectedRange()?t+=(e["class-selected-range"]?.textContent||"")+" ":this.isPartiallySelected()?t+=(e["class-partially-selected"]?.textContent||"")+" ":typeof this.isDisabled=="function"&&this.isDisabled(this.d)?t+=(e["class-disabled"]?.textContent||"")+" ":t+=(e["class-default"]?.textContent||"")+" ",this.isToday()&&(t+=(e["class-today"]?.textContent||"")+" "),t},"@click"(){this.handleDayClick()},"@mouseenter"(){this.mouseOverDate=this.d}}}})}document.addEventListener("alpine:init",()=>{Alpine.plugin(m)});})();
