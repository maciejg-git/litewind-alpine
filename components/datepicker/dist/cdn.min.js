(()=>{function g(s){s.data("datepicker",()=>{let d=(e,t)=>Array.from({length:t},(n,a)=>a+e),o=(e,t)=>32-new Date(e,t,32).getDate(),_=(e,t)=>e-1<0?{m:11,y:t-1}:{m:e-1,y:t},c=(e,t)=>e+1>11?{m:0,y:t+1}:{m:e+1,y:t},y=(e,t,n)=>{let a=new Date(e,t).getDay();return n?(6+a)%7:a},m=e=>{try{return Intl.getCanonicalLocales(e),1}catch(t){console.warn(t)}};return{_today:new Date,_month:null,_year:null,_names:{months:null,weekdays:null},_model:"",_selectedSingle:null,_selectedRange:[],_rangeState:0,_mouseOverDate:null,_locale:"en-GB",_mondayFirstWeekday:!0,_adjacentMonthsDays:!0,_range:!1,init(){this._month=this._today.getMonth(),this._year=this._today.getFullYear(),this.$nextTick(()=>{s.effect(()=>{let e=s.bound(this.$el,"data-locale")??this._locale;this._locale=m(e)?e:this._locale,this._names.months=this.getMonthNames(),this._names.weekdays=this.getWeekdayNames()}),s.effect(()=>{this._mondayFirstWeekday=JSON.parse(s.bound(this.$el,"data-monday-first-weekday")??this._mondayFirstWeekday)}),s.effect(()=>{this._adjacentMonthsDays=JSON.parse(s.bound(this.$el,"data-adjacent-months-days")??this._adjacentMonthsDays)}),s.effect(()=>{this._range=JSON.parse(s.bound(this.$el,"data-range")??this._range),this.reset()})}),s.effect(()=>{let e=/^\d{4}-\d{2}-\d{2}$/;if(this._range){if(this._model?.length===2){this._model.every(t=>e.test(t))&&(this._selectedRange=this._model.map(t=>new Date(t)),this._rangeState=2);return}this._model?.length===0&&(this._selectedRange=[],this._rangeState=0);return}(this._model===""||this._model===null)&&(this._selectedSingle=null),e.test(this._model)&&(this._selectedSingle=new Date(this._model))}),s.bind(this.$el,{"x-modelable":"_model"})},getMonthNames(){return Array.from({length:12},(e,t)=>new Date(0,t,1).toLocaleString(this._locale,{month:"short"}))},getWeekdayNames(){return Array.from({length:7},(e,t)=>new Date(2021,1,this._mondayFirstWeekday?t+1:t).toLocaleString(this._locale,{weekday:"short"}))},dateToModel(e){return e.toISOString().substring(0,10)},todayFormatted(){return this._today.toLocaleDateString(this._locale,{weekday:"long",year:"numeric",month:"long",day:"numeric"})},setNextMonth(){({m:this._month,y:this._year}=c(this._month,this._year))},setPrevMonth(){({m:this._month,y:this._year}=_(this._month,this._year))},setNextYear(){this._year++},setPrevYear(){this._year--},weekdays(){return this._names.weekdays},days(){let e=y(this._year,this._month,this._mondayFirstWeekday),t=o(this._year,this._month),n=d(1,t);n=n.map(i=>new Date(Date.UTC(this._year,this._month,i)));let{m:a,y:h}=_(this._month,this._year),u=o(h,a),l=d(u-e+1,e);this._adjacentMonthsDays?l=l.map(i=>new Date(Date.UTC(h,a,i))):l=l.map(i=>new Date(Date.UTC(h,a,i))),{m:a,y:h}=c(this._month,this._year);let D=42-t-e,r=null;return this._adjacentMonthsDays?(r=d(1,D),r=r.map(i=>new Date(Date.UTC(h,a,i)))):r=[],[...l,...n,...r]},currentDate(){return this._names.months?`${this._names.months[this._month]} ${this._year}`:""},reset(){this._selectedSingle="",this._selectedRange=[],this._model="",this._rangeState=0,this._mouseOverDate=null},addRange(){this._rangeState===2&&(this._selectedRange=[],this._rangeState=0),this._selectedRange[this._rangeState]=this.d,this._rangeState++,this._rangeState===2&&this._selectedRange[0]>this._selectedRange[1]&&this._selectedRange.reverse()},getDayKey(){return this.d.toISOString()+this.isAdjacent()},getDayText(){return this.d.getDate()},isToday(){return this._today.getDate()===this.d.getUTCDate()&&this._today.getMonth()===this.d.getUTCMonth()&&this._today.getFullYear()===this.d.getUTCFullYear()},isAdjacent(){return this.d.getMonth()!==this._month},isSelected(){return this._selectedSingle&&this._selectedSingle.getTime()==this.d.getTime()},isSelectedRange(){return this._range&&this._rangeState===2?this._selectedRange[0]<=this.d&&this.d<=this._selectedRange[1]:!1},isPartiallySelected(){return this._range&&this._rangeState===1?this._mouseOverDate>=this.d&&this.d>=this._selectedRange[0]||this._mouseOverDate<=this.d&&this.d<=this._selectedRange[0]:!1},handleDayClick(){if(this.isAdjacent()&&(this._month=this.d.getMonth(),this._year=this.d.getFullYear()),this._range){this.addRange(),this._rangeState===2&&(this._model=this._selectedRange.map(e=>this.dateToModel(e)),this.$dispatch("datepicker-selection-complete"));return}this._selectedSingle=this.d,this._model=this.dateToModel(this._selectedSingle),this.$dispatch("datepicker-selection-complete")},prevMonthButton:{"@click"(){this.setPrevMonth()}},nextMonthButton:{"@click"(){this.setNextMonth()}},prevYearButton:{"@click"(){this.setPrevYear()}},nextYearButton:{"@click"(){this.setNextYear()}},day:{":class"(){let e=this.$el.attributes,t="";if(this.isAdjacent()){if(!this._adjacentMonthsDays){this.$el.style.visibility="hidden";return}return e["class-adjacent"]?.textContent||""}return this.isSelected()?t+=(e["class-selected"]?.textContent||"")+" ":this.isSelectedRange()?t+=(e["class-selected-range"]?.textContent||"")+" ":this.isPartiallySelected()?t+=(e["class-partially-selected"]?.textContent||"")+" ":typeof this.isDisabled=="function"&&this.isDisabled(this.d)?t+=(e["class-disabled"]?.textContent||"")+" ":t+=(e["class-default"]?.textContent||"")+" ",this.isToday()&&(t+=(e["class-today"]?.textContent||"")+" "),t},"@click"(){this.handleDayClick()},"@mouseenter"(){this._mouseOverDate=this.d}}}})}document.addEventListener("alpine:init",()=>{Alpine.plugin(g)});})();
